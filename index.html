<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>團體參觀訪問申請單（表單版｜純 HTML）</title>
<style>
  :root{
    --paper-w:210mm; --paper-h:297mm;
    --font: system-ui, -apple-system, "Microsoft JhengHei", Arial, sans-serif;
    --border:#111; --muted:#f6f7fb;
  }
  html,body{height:100%}
  body{margin:0; font-family:var(--font); background:#f5f6f8; color:#111}
  h1{margin:16px 20px 8px; font-size:20px}
  .container{max-width:1080px; margin:0 auto; padding:0 16px 24px}
  .card{background:#fff;border:1px solid #e5e7eb;border-radius:12px;box-shadow:0 1px 2px rgba(0,0,0,.05); margin-top:12px}
  .card h2{font-size:16px;margin:0;padding:12px 16px;border-bottom:1px solid #eef2f7}
  .card .content{padding:14px 16px 16px}

  /* 表單 */
  form .row{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
  label{display:block;font-size:12px;color:#374151;margin:4px 0 4px}
  input, textarea, select{
    width:100%; box-sizing:border-box; padding:8px 10px; border:1px solid #c9ced6; border-radius:8px; background:#fff; font-size:14px;
  }
  input:focus, textarea:focus{outline:2px solid #2563eb22; border-color:#2563eb}
  .col-12{grid-column:span 12}.col-6{grid-column:span 6}.col-4{grid-column:span 4}.col-8{grid-column:span 8}.col-3{grid-column:span 3}.col-5{grid-column:span 5}
  .actions{display:flex; gap:8px; margin-top:12px; flex-wrap:wrap}
  .btn{cursor:pointer;border:0;border-radius:10px;padding:10px 14px;font-weight:700;font-size:14px}
  .btn.primary{background:#1f8bff;color:#fff}
  .btn.secondary{background:#eef2ff;color:#1e40af}
  .btn.ghost{background:#fff;border:1px solid #cbd5e1;color:#334155}

  /* 列印版（A4） */
  .paper{width:var(--paper-w); min-height:var(--paper-h); background:#fff; margin:16px auto; border:1px solid #e5e7eb; box-shadow:0 1px 6px rgba(0,0,0,.08)}
  .paper .inner{padding:14mm}
  .title{font-size:18px;font-weight:800;text-align:center;margin-bottom:2mm}
  .org-text { display:inline; }
  .org-img { display:inline; }
  table.form{width:100%; border-collapse:collapse; table-layout:fixed; font-size:13px}
  table.form th, table.form td{border:1px solid var(--border); padding:6px 6px; vertical-align:top; word-break:break-word}
  table.form th{background:#f2f2f2; text-align:left; font-weight:700}
  .mb10{margin-bottom:10px}
  .note{font-size:11px; color:#4b5563; line-height:1.6}
  .checkbox{display:flex; gap:14px; align-items:center; font-size:13px}
  .square{display:inline-block; width:12px; height:12px; border:1px solid #111; margin-right:6px; vertical-align:-1px}
  .checked{background:#111}
  .right{text-align:right}
  .gray{color:#6b7280}

  /* 切換顯示 */
  #printView{display:none}
  .show-print #formView{display:none}
  .show-print #printView{display:block}

  /* 印表設定 */
  @page{ size:A4; margin:12mm }
  @media print{
    body{background:#fff}
    .container, .card{border:0; box-shadow:none}
    #formView{display:none}
    #printView{display:block}
    .paper{border:0; box-shadow:none; margin:0 auto}
    *{-webkit-print-color-adjust:exact; print-color-adjust:exact}
  }
  .org-text { display:inline; }
.org-img { display:inline; }

@media print {
  .org-text { display:none; }
  .org-img { display:inline; }
}
</style>
</head>
<body>
<div class="container" id="app">

  <!-- 表單區 -->
  <h1></h1>
  <div class="card" id="formView">
    <h2>請填寫資料</h2>
    <div class="content">
      <form id="f" class="row" onsubmit="return false">
        <div class="col-4">
          <label>申請日期</label>
          <input type="date" name="apply_date">
        </div>
        <div class="col-8"></div>

        <div class="col-12">
          <label>參訪團體</label>
          <input type="text" name="group_name" placeholder="○○學校／協會" required>
        </div>

        <div class="col-4">
          <label>預定參訪日期</label>
          <input type="date" name="visit_date" required>
        </div>
        <div class="col-4">
          <label>開始時間</label>
          <input type="time" name="visit_time_start" required>
        </div>
        <div class="col-4">
          <label>結束時間</label>
          <input type="time" name="visit_time_end" required>
        </div>

        <div class="col-6">
          <label>主要聯絡人</label>
          <input type="text" name="contact_name" required>
        </div>
        <div class="col-6">
          <label>職稱</label>
          <input type="text" name="contact_title">
        </div>

        <div class="col-3">
          <label>市話區碼</label>
          <input type="text" name="tel_area" placeholder="02">
        </div>
        <div class="col-5">
          <label>市話號碼</label>
          <input type="text" name="tel_number" placeholder="12345678">
        </div>
        <div class="col-4">
          <label>分機</label>
          <input type="text" name="tel_ext" placeholder="123">
        </div>

        <div class="col-6">
          <label>手機</label>
          <input type="text" name="mobile" placeholder="09xx-xxx-xxx">
        </div>
        <div class="col-6">
          <label>預計參訪人數</label>
          <input type="number" name="people_count" min="1" max="9999">
        </div>

        <div class="col-12">
          <label>聯絡E-mail</label>
          <input type="text" name="address">
        </div>

        <div class="col-12">
          <label>預參訪本協會服務據點</label>
          <input type="text" name="visit_unit" placeholder="（例如：XX中心/部門）">
        </div>

        <div class="col-12">
          <label>其他需求說明</label>
          <textarea name="other_requirements" rows="5" placeholder="如需簡介、PPT、攝影/動線、身心障礙者協助等"></textarea>
        </div>

        <div class="col-12 actions">
          <button class="btn primary" id="makePrint">產生列印版</button>
          <button class="btn secondary" id="save">儲存</button>
          <button class="btn ghost" id="load">載入</button>
          <button class="btn ghost" id="clear">清空</button>
        </div>
      </form>
    </div>
  </div>

  <!-- 列印區 -->
  <div id="printView">
    <div class="paper">
      <div class="inner">
       <div class="org">
            <img class="org-img" src="gp1.png" alt="Logo" style="height:auto; width: auto;">
      </div>
        <div class="title">團體參觀訪問申請單</div>

        <table class="form mb10">
          <colgroup><col style="width:22%"><col style="width:78%"></colgroup>
          <tr>
            <th>申請（填表）日期</th>
            <td><span id="v_apply_date_ymd">＿＿年＿＿月＿＿日</span></td>
          </tr>
          <tr>
            <th>參訪團體</th>
            <td><span id="v_group_name"></span></td>
          </tr>
        </table>

        <table class="form mb10">
          <colgroup><col style="width:22%"><col style="width:78%"></colgroup>
          <tr>
            <th>預定參訪時間</th>
            <td>
              日期：<span id="v_visit_date"></span><br>
              時間：<span id="v_visit_time"></span>
            </td>
          </tr>
        </table>

        <table class="form mb10">
          <colgroup>
            <col style="width:22%"><col style="width:28%"><col style="width:22%"><col style="width:28%">
          </colgroup>
          <tr>
            <th>主要聯絡人</th>
            <td id="v_contact_name"></td>
            <th>職稱</th>
            <td id="v_contact_title"></td>
          </tr>
          <tr>
            <th>聯絡電話</th>
            <td colspan="3">
              市話：<span class="gray">（區碼）</span><span id="v_tel_area"></span>
              <span class="gray">（電話）</span><span id="v_tel_number"></span>
              <span class="gray">（分機）</span><span id="v_tel_ext"></span><br>
              手機：<span id="v_mobile"></span>
            </td>
          </tr>
          <tr>
            <th>聯絡E-mail</th>
            <td colspan="3" id="v_address"></td>
          </tr>
        </table>

        <table class="form mb10">
          <colgroup>
            <col style="width:22%"><col style="width:28%"><col style="width:22%"><col style="width:28%">
          </colgroup>
          <tr>
            <th>預計參訪人數</th>
            <td id="v_people_count"></td>
            <th>預參訪本協會服務據點</th>
            <td id="v_visit_unit"></td>
          </tr>
        </table>

        <table class="form mb10">
          <tr>
            <th style="width:22%">其他需求說明</th>
            <td style="width:78%; height:60mm">
              <div id="v_other_requirements" style="min-height:55mm; white-space:pre-wrap"></div>
            </td>
          </tr>
        </table>

        <div class="note">
          說明：<br>
          一、開放參觀時段：同單位以一個月二次為限，每次參觀時間以 1.5 小時為限，實際參觀時間依本會排定為準。<br>
          二、請在預定參訪 2 週前提出申請，謝謝配合。<br>
          三、若需要拍照或攝影，請避開中心課輔。<br>
          四、本會業務窗口公關處 e-mail：pr@slsc.org.tw
        </div>

        <div style="height:8mm"></div>

        <table class="form">
          <tr>
            <th style="width:22%">本會回復</th>
            <td style="width:78%">
              <div class="checkbox"><span id="v_accept" class="square"></span>接受參訪，將由本會＿＿＿＿＿負責接待，聯絡電話：＿＿＿＿＿＿</div>
              <div class="checkbox"><span id="v_reject" class="square"></span>無法接受參訪</div>
            </td>
          </tr>
        </table>

      </div>
    </div>

    <div class="actions" style="justify-content:center">
      <button class="btn secondary" id="backEdit">返回修改</button>
      <button class="btn primary" onclick="window.print()">列印 / 另存 PDF</button>
    </div>
  </div>

</div>

<script>
  const $ = s => document.querySelector(s);
  const fdToObj = form => Object.fromEntries(new FormData(form).entries());
  const set = (id, text) => { const el = $(id); if(!el) return; el.textContent = text || ''; };

  // 填入列印版
  function fillPrintView(data){
    // 申請日期
    const d = data.apply_date || new Date().toISOString().slice(0,10);
    const [y,m,dd] = d.split('-');
    set('#v_apply_date_ymd', `${y||'＿＿'}年${m||'＿＿'}月${dd||'＿＿'}日`);

    set('#v_group_name', data.group_name);
    set('#v_visit_date', data.visit_date || '');
    set('#v_visit_time', [data.visit_time_start, data.visit_time_end].filter(Boolean).join('–'));

    set('#v_contact_name', data.contact_name);
    set('#v_contact_title', data.contact_title);

    set('#v_tel_area', data.tel_area);
    set('#v_tel_number', data.tel_number);
    set('#v_tel_ext', data.tel_ext);
    set('#v_mobile', data.mobile);
    set('#v_address', data.address);
    set('#v_people_count', data.people_count);
    set('#v_visit_unit', data.visit_unit);
    set('#v_other_requirements', data.other_requirements);
  }

  // 切換畫面
  function showPrint(){ document.body.classList.add('show-print'); }
  function showForm(){ document.body.classList.remove('show-print'); }

  // 初始
  document.addEventListener('DOMContentLoaded', () => {
    // 預填今天
    $('input[name="apply_date"]').value = new Date().toISOString().slice(0,10);

    // 產生列印版
    $('#makePrint').addEventListener('click', () => {
      const data = fdToObj($('#f'));
      fillPrintView(data);
      showPrint();
      // 可選：自動打開列印視窗
      // setTimeout(()=>window.print(), 50);
    });

    // 返回修改
    $('#backEdit').addEventListener('click', showForm);

    // 儲存/載入/清空
    const KEY='visit_form_saved_v1';
    $('#save').addEventListener('click', ()=>{
      localStorage.setItem(KEY, JSON.stringify(fdToObj($('#f'))));
      alert('已儲存');
    });
    $('#load').addEventListener('click', ()=>{
      const raw = localStorage.getItem(KEY);
      if(!raw) return alert('沒有可載入的資料');
      try{
        const data = JSON.parse(raw);
        for(const k in data){ const el = $(`[name="${k}"]`); if(el) el.value = data[k]; }
      }catch(e){ alert('載入失敗'); }
    });
    $('#clear').addEventListener('click', ()=> $('#f').reset());
  });
</script>
</body>
</html>
